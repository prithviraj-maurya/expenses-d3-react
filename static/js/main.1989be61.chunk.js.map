{"version":3,"sources":["images/delete.svg","visualizations/Expenses.js","visualizations/Day.js","visualizations/Categories.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","margin","xScale","d3","domain","yScale","range","amountScale","simulation","alphaDecay","velocityDecay","force","d","radius","focusX","focusY","stop","drag","App","props","state","forceTick","bind","dragStart","dragExpense","dragEnd","mouseOver","this","width","on","container","refs","append","hover","attr","fontSize","colors","white","black","style","calculateData","renderCircles","nodes","expenses","alpha","restart","weeksExtent","floor","date","amountExtent","amount","_","chain","groupBy","map","week","Date","exp","calculateDayPosition","x","y","Object","assign","flatten","value","minDate","maxDate","selectedWeek","offset","days","union","shouldSelectedWeekCurve","dayOfWeek","getDay","getTime","height","Math","abs","circles","selectAll","data","name","exit","remove","enter","classed","call","merge","categories","dragging","alphaTarget","subject","fx","fy","dragged","expense","expenseX","expenseY","each","category","type","day","active","linkToCategory","editDate","select","text","split","capitalize","join","node","getBoundingClientRect","ref","Component","colorScale","chroma","scale","Day","renderBacks","renderDays","totalsByDay","reduce","obj","sumBy","totalsExtent","values","total","fill","backs","insert","gray","t","duration","transition","delay","i","timeFormat","dayHeight","deleteIcon","deleteIconY","deleteIconSrc","renderLinks","links","filter","push","source","target","random","categoryBeingAdded","lines","angle","atan2","PI","direction","dist","sqrt","pow","categoryX","categoryY","deleteCategory","prevWeek","nextWeek","addCategory","startCategory","clearCategory","expensesData","Amount","id","Description","setState","includes","without","forceUpdate","event","blur","keyCode","svgStyle","overflow","position","top","zIndex","inputStyle","textAlign","display","padding","background","color","border","borderBottom","className","cursor","onClick","placeholder","onFocus","onBlur","onKeyDown","Categories","Expenses","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.1989be61.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/delete.b6937761.svg\";","import React, { Component } from 'react';\r\nimport * as d3 from 'd3';\r\nimport _ from 'lodash';\r\n\r\nvar height = 650;\r\nvar dayWidth = 55;\r\nvar dayHeight = 75;\r\nvar margin = { left: 40, top: 20, right: 40, bottom: 20 };\r\nvar topPadding = 150;\r\nvar radius = 8;\r\nvar fontSize = 14;\r\n\r\n// d3 functions\r\nvar xScale = d3.scaleLinear().domain([0, 6]);\r\nvar yScale = d3.scaleLinear().range([height - margin.bottom, margin.top]);\r\nvar amountScale = d3.scaleLinear().range([radius, 3 * radius]);\r\nvar simulation = d3.forceSimulation()\r\n    .alphaDecay(0.001)\r\n    .velocityDecay(0.3)\r\n    .force('collide', d3.forceCollide(d => d.radius + 2))\r\n    .force('x', d3.forceX(d => d.focusX))\r\n    .force('y', d3.forceY(d => d.focusY))\r\n    .stop();\r\nvar drag = d3.drag();\r\n\r\nclass App extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {};\r\n        this.forceTick = this.forceTick.bind(this);\r\n        this.dragStart = this.dragStart.bind(this);\r\n        this.dragExpense = this.dragExpense.bind(this);\r\n        this.dragEnd = this.dragEnd.bind(this);\r\n        this.mouseOver = this.mouseOver.bind(this);\r\n    }\r\n\r\n    componentWillMount() {\r\n        xScale.range([margin.left, this.props.width - margin.right]);\r\n        simulation.on('tick', this.forceTick);\r\n        drag.on('start', this.dragStart)\r\n            .on('drag', this.dragExpense)\r\n            .on('end', this.dragEnd);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.container = d3.select(this.refs.container).append('g');\r\n        this.hover = d3.select(this.refs.container).append('g');\r\n        this.hover.append('rect')\r\n            .attr('height', fontSize + 4)\r\n            .attr('y', -fontSize / 2 - 2)\r\n            .attr('opacity', 0.85)\r\n            .attr('fill', this.props.colors.white);\r\n        this.hover.append('text')\r\n            .attr('text-anchor', 'middle')\r\n            .attr('dy', '.35em')\r\n            .attr('fill', this.props.colors.black)\r\n            .style('font-size', fontSize)\r\n            .style('pointer-events', 'none');\r\n\r\n        this.calculateData();\r\n        this.renderCircles();\r\n\r\n        simulation.nodes(this.props.expenses).alpha(0.9).restart();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.calculateData();\r\n        this.renderCircles();\r\n\r\n        simulation.nodes(this.props.expenses).alpha(0.9).restart();\r\n    }\r\n\r\n    calculateData() {\r\n        var weeksExtent = d3.extent(this.props.expenses,\r\n            d => d3.timeWeek.floor(d.date));\r\n        yScale.domain(weeksExtent);\r\n        var amountExtent = d3.extent(this.props.expenses, d => d.amount);\r\n        amountScale.domain(amountExtent);\r\n\r\n        this.expenses = _.chain(this.props.expenses)\r\n            .groupBy(d => d3.timeWeek.floor(d.date))\r\n            .map((expenses, week) => {\r\n                week = new Date(week);\r\n                return _.map(expenses, exp => {\r\n                    var { x, y } = this.calculateDayPosition(exp.date, true);\r\n\r\n                    return Object.assign(exp, {\r\n                        radius: amountScale(exp.amount),\r\n                        focusX: x,\r\n                        focusY: y,\r\n                        x: exp.x || x,\r\n                        y: exp.y || y,\r\n                    });\r\n                });\r\n            }).flatten().value()\r\n\r\n        // get min+max dates\r\n        var [minDate, maxDate] = d3.extent(this.props.expenses,\r\n            d => d3.timeDay.floor(d.date));\r\n        // calculate all potential dates to drag expenses into\r\n        var selectedWeek = d3.timeDay.range(this.props.selectedWeek,\r\n            d3.timeWeek.offset(this.props.selectedWeek, 1));\r\n        this.days = _.chain(selectedWeek)\r\n            .map(date => Object.assign(this.calculateDayPosition(date, true), { date }))\r\n            .union(_.map(d3.timeDay.range(minDate, maxDate),\r\n                (date) => Object.assign(this.calculateDayPosition(date), { date })))\r\n            .value();\r\n    }\r\n\r\n    calculateDayPosition(date, shouldSelectedWeekCurve) {\r\n        var dayOfWeek = date.getDay();\r\n        var week = d3.timeWeek.floor(date);\r\n        var x = xScale(dayOfWeek);\r\n        var y = yScale(week) + height + 2 * dayHeight;\r\n\r\n        if (shouldSelectedWeekCurve &&\r\n            week.getTime() === this.props.selectedWeek.getTime()) {\r\n            var offset = Math.abs(3 - dayOfWeek);\r\n            y = height - 2 * dayHeight - 0.5 * offset * dayHeight;\r\n        }\r\n        y += topPadding;\r\n\r\n        return { x, y };\r\n    }\r\n\r\n    renderCircles() {\r\n        // draw expenses circles\r\n        this.circles = this.container.selectAll('.expense')\r\n            .data(this.expenses, d => d.name);\r\n\r\n        // exit\r\n        this.circles.exit().remove();\r\n\r\n        // enter+update\r\n        this.circles = this.circles.enter().append('circle')\r\n            .classed('expense', true)\r\n            .attr('fill', this.props.colors.white)\r\n            .style('cursor', 'move')\r\n            .call(drag)\r\n            .on('mouseover', this.mouseOver)\r\n            .on('mouseleave', () => this.hover.style('display', 'none'))\r\n            .merge(this.circles)\r\n            .attr('r', d => d.radius)\r\n            .attr('stroke', d => d.categories ? this.props.colors.black : '');\r\n    }\r\n\r\n    forceTick() {\r\n        this.circles.attr('cx', d => d.x)\r\n            .attr('cy', d => d.y);\r\n    }\r\n\r\n    dragStart() {\r\n        this.dragging = true;\r\n        this.hover.style('display', 'none')\r\n\r\n        simulation.alphaTarget(0.3).restart();\r\n        d3.event.subject.fx = d3.event.subject.x;\r\n        d3.event.subject.fy = d3.event.subject.y;\r\n    }\r\n\r\n    dragExpense() {\r\n        this.dragged = null;\r\n\r\n        d3.event.subject.fx = d3.event.x;\r\n        d3.event.subject.fy = d3.event.y;\r\n\r\n        var expense = d3.event.subject;\r\n        var expenseX = d3.event.x;\r\n        var expenseY = d3.event.y;\r\n        // go through all categories to see if overlapping\r\n        _.each(this.props.categories, category => {\r\n            var { x, y, radius } = category;\r\n            if (x - radius < expenseX && expenseX < x + radius &&\r\n                y - radius < expenseY && expenseY < y + radius) {\r\n                this.dragged = { expense, category, type: 'category' };\r\n            }\r\n        });\r\n        // go through all the days to see if expense overlaps\r\n        _.each(this.days, day => {\r\n            var { x, y } = day;\r\n            if (x - dayWidth < expenseX && expenseX < x + dayWidth &&\r\n                y - dayHeight < expenseY && expenseY < y + dayHeight) {\r\n                this.dragged = { expense, day, type: 'day' };\r\n            }\r\n        });\r\n    }\r\n\r\n    dragEnd() {\r\n        if (!d3.event.active) simulation.alphaTarget(0);\r\n        d3.event.subject.fx = null;\r\n        d3.event.subject.fy = null;\r\n\r\n        if (this.dragged) {\r\n            var { expense, category, day } = this.dragged;\r\n            if (this.dragged.type === 'category') {\r\n                this.props.linkToCategory(expense, category);\r\n            } else if (this.dragged.type === 'day') {\r\n                this.props.editDate(expense, day);\r\n            }\r\n        }\r\n        this.dragged = null;\r\n        this.dragging = false;\r\n    }\r\n\r\n    mouseOver(d) {\r\n        if (this.dragging) return;\r\n        this.hover.style('display', 'block');\r\n\r\n        var { x, y, name } = d;\r\n        this.hover.attr('transform', 'translate(' + [x, y + d.radius + fontSize] + ')');\r\n        this.hover.select('text')\r\n            .text(_.map(name.split(' '), _.capitalize).join(' '));\r\n        var width = this.hover.select('text').node().getBoundingClientRect().width;\r\n        this.hover.select('rect')\r\n            .attr('width', width + 6)\r\n            .attr('x', -width / 2 - 3);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <g ref='container' />\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React, { Component } from 'react';\r\nimport * as d3 from 'd3';\r\nimport _ from 'lodash';\r\n\r\nimport chroma from 'chroma-js';\r\n\r\nvar height = 650;\r\nvar dayWidth = 55;\r\nvar dayHeight = 75;\r\nvar topPadding = 150;\r\nvar margin = {left: 40, top: 20, right: 40, bottom: 20};\r\n\r\n// d3 functions\r\nvar xScale = d3.scaleLinear().domain([0, 6]);\r\nvar yScale = d3.scaleLinear().range([height - margin.bottom, margin.top]);\r\nvar amountScale = d3.scaleLog();\r\nvar colorScale = chroma.scale(['#53c3ac', '#f7e883', '#e85178']);\r\n\r\nclass Day extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {};\r\n  }\r\n\r\n  componentWillMount() {\r\n    xScale.range([margin.left, this.props.width - margin.right]);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.container = d3.select(this.refs.container);\r\n    this.calculateData();\r\n    this.renderBacks();\r\n    this.renderDays();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.calculateData();\r\n    this.renderDays();\r\n  }\r\n\r\n  calculateData() {\r\n    var weeksExtent = d3.extent(this.props.expenses,\r\n      d => d3.timeWeek.floor(d.date));\r\n    yScale.domain(weeksExtent);\r\n\r\n    this.totalsByDay = _.chain(this.props.expenses)\r\n      .groupBy(d => d3.timeDay.floor(d.date))\r\n      .reduce((obj, expenses, date) => {\r\n        obj[date] = _.sumBy(expenses, 'amount');\r\n        return obj;\r\n      }, {}).value();\r\n    // get min+max total amounts per day\r\n    var totalsExtent = d3.extent(_.values(this.totalsByDay));\r\n    amountScale.domain(totalsExtent);\r\n\r\n    this.days = _.map(this.totalsByDay, (total, date) => {\r\n      date = new Date(date);\r\n      var {x, y} = this.calculateDayPosition(date, true);\r\n\r\n      return {\r\n        date,\r\n        fill: colorScale(amountScale(total)),\r\n        x, y,\r\n      };\r\n    });\r\n\r\n    // get min+max dates\r\n    var [minDate, maxDate] = d3.extent(this.props.expenses,\r\n      d => d3.timeDay.floor(d.date));\r\n    // backs should be all dates in range as well as an extra for selectedWeek\r\n    var selectedWeek = d3.timeDay.range(this.props.selectedWeek,\r\n      d3.timeWeek.offset(this.props.selectedWeek, 1));\r\n    this.backs = _.chain(selectedWeek)\r\n      .map(date => this.calculateDayPosition(date, true))\r\n      .union(_.map(d3.timeDay.range(minDate, maxDate),\r\n        (date) => this.calculateDayPosition(date)))\r\n      .value();\r\n  }\r\n\r\n  calculateDayPosition(date, shouldSelectedWeekCurve) {\r\n    var dayOfWeek = date.getDay();\r\n    var week = d3.timeWeek.floor(date);\r\n    var x = xScale(dayOfWeek);\r\n    var y = yScale(week) + height + 2 * dayHeight;\r\n\r\n    if (shouldSelectedWeekCurve &&\r\n      week.getTime() === this.props.selectedWeek.getTime()) {\r\n      var offset = Math.abs(3 - dayOfWeek);\r\n      y = height - 2 * dayHeight - 0.5 * offset * dayHeight;\r\n    }\r\n    y += topPadding;\r\n\r\n    return {x, y};\r\n  }\r\n\r\n  renderBacks() {\r\n    this.container.selectAll('.back')\r\n      .data(this.backs, d => d.date)\r\n      .enter().insert('rect', '.day')\r\n      .classed('back', true)\r\n      .attr('transform', d => 'translate(' + [d.x, d.y] + ')')\r\n      .attr('width', 2 * dayWidth)\r\n      .attr('height', 2 * dayHeight)\r\n      .attr('x', -dayWidth)\r\n      .attr('y', -dayHeight)\r\n      .attr('fill', this.props.colors.gray);\r\n  }\r\n\r\n  renderDays() {\r\n    var t = d3.transition().duration(500);\r\n    var fontSize = 20;\r\n\r\n    var days = this.container.selectAll('.day')\r\n      .data(this.days, d => d.date);\r\n\r\n    // exit\r\n    days.exit().remove();\r\n\r\n    // enter\r\n    var enter = days.enter().append('g')\r\n      .classed('day', true)\r\n      .attr('transform', d => 'translate(' + [d.x, d.y] + ')');\r\n    enter.append('rect')\r\n      .attr('fill', d => d.fill);\r\n    enter.append('text')\r\n      .attr('text-anchor', 'middle')\r\n      .attr('dy', '.35em')\r\n      .attr('fill', this.props.colors.white)\r\n      .style('font-family', 'CatMule Caps')\r\n      .style('font-size', fontSize);\r\n\r\n    days = enter.merge(days);\r\n    days.transition(t)\r\n      .delay((d, i) => d.date.getDay() * 50)\r\n      .attr('transform', d => 'translate(' + [d.x, d.y] + ')');\r\n\r\n    days.select('rect')\r\n      .attr('width', 2 * dayWidth)\r\n      .attr('height', 2 * dayHeight)\r\n      .attr('x', -dayWidth)\r\n      .attr('y', -dayHeight)\r\n      .transition(t)\r\n      .attr('fill', d => d.fill);\r\n\r\n    var timeFormat = d3.timeFormat('%m/%d');\r\n    days.select('text')\r\n      .attr('y', d => dayHeight - 0.75 * fontSize)\r\n      .text(d => timeFormat(d.date));\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <g ref='container' />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Day;\r\n","import React, { Component } from 'react';\r\nimport * as d3 from 'd3';\r\nimport _ from 'lodash';\r\nimport chroma from 'chroma-js';\r\nimport deleteIconSrc from '../images/delete.svg';\r\n\r\nvar height = 600;\r\nvar topPadding = 150;\r\nvar radius = 55;\r\n// var white = '#fff8fa';\r\nvar deleteIconY = 160;\r\nvar deleteIconRadius = 24;\r\n\r\nvar amountScale = d3.scaleLog();\r\nvar colorScale = chroma.scale(['#53c3ac', '#f7e883', '#e85178']);\r\nvar simulation = d3.forceSimulation()\r\n    .alphaDecay(0.001)\r\n    .velocityDecay(0.3)\r\n    .force('collide', d3.forceCollide(d => d.radius + 10))\r\n    .force('x', d3.forceX(d => d.focusX))\r\n    .force('y', d3.forceY(d => d.focusY))\r\n    .stop();\r\nvar drag = d3.drag();\r\n\r\nclass App extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {};\r\n\r\n        this.forceTick = this.forceTick.bind(this);\r\n        this.dragStart = this.dragStart.bind(this);\r\n        this.dragExpense = this.dragExpense.bind(this);\r\n        this.dragEnd = this.dragEnd.bind(this);\r\n\r\n        simulation.on('tick', this.forceTick);\r\n        drag.on('start', this.dragStart)\r\n            .on('drag', this.dragExpense)\r\n            .on('end', this.dragEnd);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.container = d3.select(this.refs.container);\r\n        // create delete icon\r\n        this.deleteIcon = this.container.append('image')\r\n            .attr('x', this.props.width / 2 - deleteIconRadius)\r\n            .attr('y', deleteIconY - deleteIconRadius)\r\n            .attr('width', 2 * deleteIconRadius)\r\n            .attr('height', 2 * deleteIconRadius)\r\n            .attr('xlink:href', deleteIconSrc)\r\n            .attr('fill', this.props.colors.black)\r\n            .style('display', 'none');\r\n\r\n        this.calculateData();\r\n        this.renderLinks();\r\n        this.renderCircles();\r\n\r\n        simulation.nodes(this.categories).alpha(0.9).restart();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.calculateData();\r\n        this.renderLinks();\r\n        this.renderCircles();\r\n\r\n        simulation.nodes(this.categories).alpha(0.9).restart();\r\n    }\r\n\r\n    calculateData() {\r\n        var totalsByDay = _.chain(this.props.expenses)\r\n            .groupBy(d => d3.timeDay.floor(d.date))\r\n            .map(expenses => _.sumBy(expenses, 'amount'))\r\n            .value();\r\n        // get min+max total amounts per day\r\n        var totalsExtent = d3.extent(_.values(totalsByDay));\r\n        amountScale.domain(totalsExtent);\r\n\r\n        var width = this.props.width;\r\n        this.links = [];\r\n        // calculate existing categories\r\n        this.categories = _.map(this.props.categories, category => {\r\n            var total = 0;\r\n            _.chain(category.expenses)\r\n                .filter(expense => d3.timeWeek.floor(expense.date).getTime() ===\r\n                    this.props.selectedWeek.getTime())\r\n                .each(expense => {\r\n                    total += expense.amount;\r\n                    this.links.push({\r\n                        source: expense,\r\n                        target: category,\r\n                    });\r\n                }).value();\r\n\r\n            return Object.assign(category, {\r\n                total,\r\n                fill: colorScale(amountScale(total)),\r\n                radius,\r\n                focusX: width / 2,\r\n                focusY: height / 3 + topPadding,\r\n                x: category.x || _.random(0.25 * width, 0.75 * width),\r\n                y: category.y || _.random(0.25 * height, 0.5 * height),\r\n            });\r\n        });\r\n        // if a category is currently being added, include that also\r\n        if (this.props.categoryBeingAdded) {\r\n            this.categories.push(Object.assign(this.props.categoryBeingAdded, {\r\n                fx: this.props.width / 2,\r\n                fy: 100,\r\n                radius,\r\n            }));\r\n        }\r\n\r\n    }\r\n\r\n    renderLinks() {\r\n        this.lines = this.container.selectAll('path')\r\n            .data(this.links);\r\n\r\n        // exit\r\n        this.lines.exit().remove();\r\n\r\n        // enter + update\r\n        this.lines = this.lines.enter().insert('path', 'g')\r\n            .attr('stroke', this.props.colors.black)\r\n            .attr('stroke-width', 0.5)\r\n            .attr('fill', 'none')\r\n            .merge(this.lines);\r\n    }\r\n\r\n    renderCircles() {\r\n        var t = d3.transition().duration(500);\r\n        // update\r\n        this.circles = this.container.selectAll('g')\r\n            .data(this.categories);\r\n\r\n        // exit\r\n        this.circles.exit().remove();\r\n\r\n        // enter\r\n        var enter = this.circles.enter().append('g');\r\n        enter.append('circle')\r\n            .attr('r', radius)\r\n            .attr('stroke-width', 1)\r\n            .style('cursor', 'move')\r\n            .call(drag);\r\n        enter.append('text')\r\n            .attr('text-anchor', 'middle')\r\n            .attr('dy', '.35em')\r\n            .attr('font-size', 14)\r\n            .style('pointer-events', 'none');\r\n\r\n        // enter + update selection\r\n        this.circles = enter.merge(this.circles);\r\n        this.circles.select('circle')\r\n            .transition(t)\r\n            .attr('stroke', d => d.total ? this.props.colors.black : this.props.colors.gray)\r\n            .attr('fill', d => d.total ? d.fill : this.props.colors.gray);\r\n        this.circles.select('text')\r\n            .text(d => d.name)\r\n            .transition(t)\r\n            .attr('fill', d => d.total ? this.props.colors.white : this.props.colors.black);\r\n    }\r\n\r\n    forceTick() {\r\n        this.circles.attr('transform', d => 'translate(' + [d.x, d.y] + ')');\r\n        this.lines\r\n            .attr('transform', d => {\r\n                var angle = Math.atan2(d.target.y - d.source.y, d.target.x - d.source.x);\r\n                angle *= (180 / Math.PI);\r\n                return 'translate(' + [d.source.x, d.source.y] + ')rotate(' + angle + ')';\r\n            }).attr('d', d => {\r\n                var direction = d.source.date.getDay() < 3 ? -1 : 1;\r\n                // calculate distance between source and target\r\n                var dist = Math.sqrt(Math.pow(d.target.x - d.source.x, 2) + Math.pow(d.target.y - d.source.y, 2));\r\n                return 'M0,0 Q' + [dist / 2, direction * dist / 3] + ' ' + [dist, 0];\r\n            });\r\n    }\r\n\r\n    dragStart() {\r\n        simulation.alphaTarget(0.3).restart();\r\n        d3.event.subject.fx = d3.event.subject.x;\r\n        d3.event.subject.fy = d3.event.subject.y;\r\n\r\n        this.deleteIcon.style('display', 'block');\r\n    }\r\n\r\n    dragExpense() {\r\n        d3.event.subject.fx = d3.event.x;\r\n        d3.event.subject.fy = d3.event.y;\r\n    }\r\n\r\n    dragEnd() {\r\n        if (!d3.event.active) simulation.alphaTarget(0);\r\n        d3.event.subject.fx = null;\r\n        d3.event.subject.fy = null;\r\n\r\n        this.deleteIcon.style('display', 'none');\r\n\r\n        // if dragged over the deleteIcon\r\n        var categoryX = d3.event.x;\r\n        var categoryY = d3.event.y;\r\n        if (this.props.width / 2 - deleteIconRadius < categoryX &&\r\n            categoryX < this.props.width / 2 + deleteIconRadius &&\r\n            deleteIconY - deleteIconRadius < categoryY &&\r\n            categoryY < deleteIconY + deleteIconRadius) {\r\n            this.props.deleteCategory(d3.event.subject);\r\n        }\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <g ref='container' />\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React, { Component } from 'react';\r\nimport './App.css';\r\nimport * as d3 from 'd3';\r\nimport _ from 'lodash';\r\nimport Expenses from './visualizations/Expenses';\r\nimport Day from './visualizations/Day';\r\nimport Categories from './visualizations/Categories';\r\n\r\nimport expensesData from './data/expenses.json';\r\n\r\nvar width = 750;\r\nvar height = 1800;\r\nvar colors = {\r\n  white: '#fff8fa',\r\n  gray: '#e1ecea',\r\n  black: '#516561',\r\n};\r\n\r\nclass App extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      expenses: [],\r\n      categories: [\r\n        { name: 'Restaurants', expenses: [], total: 0 },\r\n        { name: 'Travel', expenses: [], total: 0 },\r\n        { name: 'Dessert', expenses: [], total: 0 },\r\n      ],\r\n      categoryBeingAdded: null,\r\n      selectedWeek: null,\r\n    };\r\n\r\n    this.prevWeek = this.prevWeek.bind(this);\r\n    this.nextWeek = this.nextWeek.bind(this);\r\n    this.linkToCategory = this.linkToCategory.bind(this);\r\n    this.editDate = this.editDate.bind(this);\r\n    this.addCategory = this.addCategory.bind(this);\r\n    this.startCategory = this.startCategory.bind(this);\r\n    this.clearCategory = this.clearCategory.bind(this);\r\n    this.deleteCategory = this.deleteCategory.bind(this);\r\n  }\r\n\r\n  componentWillMount() {\r\n    // process data\r\n    var expenses = _.chain(expensesData)\r\n      .filter(d => d.Amount < 0)\r\n      .map((d, i) => {\r\n        return {\r\n          id: i,\r\n          amount: -d.Amount,\r\n          name: d.Description,\r\n          date: new Date(d['Trans Date']),\r\n          categories: 0,\r\n        }\r\n      }).value();\r\n\r\n    // default selected week will be the most recent week\r\n    var selectedWeek = d3.max(expenses, exp => d3.timeWeek.floor(exp.date));\r\n\r\n    this.setState({ expenses, selectedWeek });\r\n  }\r\n\r\n  prevWeek() {\r\n    // todo: error handling\r\n    var selectedWeek = d3.timeWeek.offset(this.state.selectedWeek, -1);\r\n    this.setState({ selectedWeek });\r\n  }\r\n\r\n  nextWeek() {\r\n    // todo: error handling\r\n    var selectedWeek = d3.timeWeek.offset(this.state.selectedWeek, 1);\r\n    this.setState({ selectedWeek });\r\n  }\r\n\r\n  linkToCategory(expense, category) {\r\n    if (_.includes(category.expenses, expense)) {\r\n      category.expenses = _.without(category.expenses, expense);\r\n      expense.categories -= 1;\r\n    } else {\r\n      category.expenses.push(expense);\r\n      expense.categories += 1;\r\n    }\r\n    this.forceUpdate();\r\n  }\r\n\r\n  editDate(expense, day) {\r\n    expense.date = day.date;\r\n    this.forceUpdate();\r\n  }\r\n\r\n  startCategory(event) {\r\n    var category = {\r\n      name: event.target.value,\r\n      expenses: [],\r\n      total: 0,\r\n    }\r\n    this.setState({ categoryBeingAdded: category });\r\n  }\r\n\r\n  clearCategory(event) {\r\n    event.target.value = '';\r\n    event.target.blur();\r\n    this.setState({ categoryBeingAdded: null });\r\n  }\r\n\r\n  addCategory(event) {\r\n    var ENTER_CODE = 13;\r\n    var ESC_CODE = 27;\r\n    if (event.keyCode === ESC_CODE) {\r\n      this.clearCategory(event);\r\n    } else if (event.keyCode === ENTER_CODE) {\r\n      // take the value of the input and create new category\r\n      var category = Object.assign(this.state.categoryBeingAdded, {\r\n        name: event.target.value,\r\n        fx: null,\r\n        fy: null,\r\n      });\r\n      var categories = this.state.categories;\r\n      categories.push(category);\r\n\r\n      // clear out the input form on successful submit\r\n      event.target.value = '';\r\n      event.target.blur();\r\n\r\n      this.setState({ categories, categoryBeingAdded: null });\r\n    }\r\n  }\r\n\r\n  deleteCategory(category) {\r\n    var categories = _.filter(this.state.categories, d => d.name !== category.name);\r\n    this.setState({ categories });\r\n  }\r\n\r\n  render() {\r\n    var selectedWeek = d3.timeFormat('%B %d, %Y')(this.state.selectedWeek);\r\n    var style = {\r\n      width,\r\n      margin: 'auto',\r\n    }\r\n    var svgStyle = {\r\n      overflow: 'visible',\r\n      position: 'absolute',\r\n      top: 0,\r\n      width,\r\n      height,\r\n      zIndex: -1,\r\n    }\r\n    var inputStyle = {\r\n      fontSize: 14,\r\n      textAlign: 'center',\r\n      display: 'block',\r\n      padding: 5,\r\n      width: 200,\r\n      margin: 'auto',\r\n      background: 'none',\r\n      color: colors.black,\r\n      border: 'none',\r\n      borderBottom: '2px solid ' + colors.black,\r\n    }\r\n    var props = {\r\n      width,\r\n      colors,\r\n      linkToCategory: this.linkToCategory,\r\n      editDate: this.editDate,\r\n      deleteCategory: this.deleteCategory,\r\n    };\r\n\r\n    return (\r\n      <div className='App' style={style}>\r\n        <h1 style={{ textAlign: 'center', color: colors.black }}>\r\n          <span style={{ cursor: 'pointer' }} onClick={this.prevWeek}>← </span>\r\n          Week of {selectedWeek}\r\n          <span style={{ cursor: 'pointer' }} onClick={this.nextWeek}> →</span>\r\n        </h1>\r\n        <input id='addCategory' style={inputStyle} type='text' placeholder='Add Category'\r\n          onFocus={this.startCategory} onBlur={this.clearCategory} onKeyDown={this.addCategory}></input>\r\n        <svg style={svgStyle}>\r\n          <Day {...props} {...this.state} />\r\n          <Categories {...props} {...this.state} />\r\n          <Expenses {...props} {...this.state} />\r\n        </svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}